<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapping.licaiBizRealtimeMapping">


    <!----><!----><!----><!----><!----><!----><!--注册用户数--><!----><!----><!----><!----><!----><!----><!----><!---->
    <!--注册用户数，当日实时-->
    <select id="getCurrentRegisterUsers" parameterType="String"
            resultType="com.test.group.model.biz.realtime.RealTimeModel">
        select count(DISTINCT Biz.TB_USER.ID) as currentRegisterUsers
            from TB_USER
        where
            REGISTERDATE > CURDATE();
    </select>

    <!----><!----><!----><!----><!----><!----><!--充值用户数--><!----><!----><!----><!----><!----><!----><!----><!---->
    <!--充值用户数，当日实时-->
    <select id="getCurrentPayUsers"
            resultType="com.test.group.model.biz.realtime.RealTimeModel">

        select count(distinct user_id) as currentPayUsers
        from TBL_FUND_OPERATE
        where from_unixtime(create_time/1000,'%Y-%m-%d %H:%i:%S') >= CURDATE()
        and business_status = '40'
        and role_type=1;


    </select>
    <!--充值用户数，新增注册且充值-->
    <select id="getCurrentRegisterAndPayUsers"
            resultType="com.test.group.model.biz.realtime.RealTimeModel">


        select count(distinct a.user_id) as currentRegisterAndPayUsers
        from TBL_FUND_OPERATE a join  TB_USER b
        on a.user_id=b.ID
        where
        b.REGISTERDATE>= CURDATE()
        and from_unixtime(a.create_time/1000,'%Y-%m-%d') >= CURDATE()
        and a.business_status = '40'
        and a.role_type=1


    </select>


    <!----><!----><!----><!----><!----><!----><!--投资用户数--><!----><!----><!----><!----><!----><!----><!----><!---->
    <!--投资用户数，当日实时-->
    <select id="getCurrentInvestUsers"
            resultType="com.test.group.model.biz.realtime.RealTimeModel">

        select count(DISTINCT Biz.TBL_FUND_OPERATE.user_id) as currentInvestUsers
        from   TBL_FUND_OPERATE
        where
        business_realm = 'INVEST'
        and business_status = 10
        and operate= 'FREEZE'
        and  from_unixtime(create_time/1000,'%Y-%m-%d %H:%i:%S') >= CURDATE()
        and role_type=1

    </select>


    <!----><!----><!----><!----><!----><!----><!--投资金额--><!----><!----><!----><!----><!----><!----><!----><!---->
    <!--投资金额，当日实时-->
    <select id="getCurrentInvestMoney"
            resultType="com.test.group.model.biz.realtime.RealTimeModel">



        SELECT
        (
        SELECT
        sum(amount + packet_amount) / 10000
        FROM
        TBL_FUND_OPERATE
        WHERE
        from_unixtime(
        create_time / 1000 ,
        '%Y-%m-%d %H:%i:%S'
        ) >= CURDATE()

        AND business_realm = 'INVEST'
        AND business_status = 10
        AND operate = 'FREEZE'
        AND role_type = 1
        ) AS currentInvestMoney;

    </select>


    <!----><!----><!----><!----><!----><!----><!--提现用户数--><!----><!----><!----><!----><!----><!----><!----><!---->
    <!--提现用户数，当日实时-->

    <select id="getCurrentWithdrawCashUsers"
            resultType="com.test.group.model.biz.realtime.RealTimeModel">

<!--        select count(DISTINCT Biz.TBL_WITHDRAWAL.user_id) as currentWithdrawCashUsers
            from TBL_WITHDRAWAL
                where
                    create_time >= CURDATE()
                    and user_type=1-->

        select count(DISTINCT Biz.TBL_WITHDRAWAL.user_id) as currentWithdrawCashUsers
        from TBL_WITHDRAWAL
        where
        from_unixtime(create_time/1000,'%Y-%m-%d %H:%i:%S') >= CURDATE()
        and user_type=1

    </select>


    <!----><!----><!----><!----><!----><!----><!--提现金额--><!----><!----><!----><!----><!----><!----><!----><!---->
    <!--提现金额，当日实时-->
    <select id="getCurrentWithdrawCashMoney"
            resultType="com.test.group.model.biz.realtime.RealTimeModel">

<!--
        select   (select sum(Biz.TBL_WITHDRAWAL.amount)／10000
            from TBL_WITHDRAWAL
                where
                    create_time >= CURDATE()
                    and user_type= 1)
                    as currentWithdrawCashMoney
-->


        select (
        select sum(Biz.TBL_WITHDRAWAL.amount)/10000
        from TBL_WITHDRAWAL
        where
        from_unixtime(create_time/1000,'%Y-%m-%d %H:%i:%S') >= CURDATE()
        and user_type= 1
        )as currentWithdrawCashMoney
    </select>


</mapper>